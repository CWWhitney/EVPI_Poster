---
title: Expected Value of Perfect Information
csl: nature.csl
author:
  - name: Katja Schiffers
    affil: 1
    orcid: '0000-0003-2559-6579'
  - name: Cory Whitney
    affil: 1
    orcid: '0000-0003-4988-4583'
  - name: Eike Luedeling
    affil: 1
    orcid: '0000-0002-7316-3631'
affiliation:
  - num: 1
    address: INRES Horticultural Sciences, University of Bonn
column_numbers: 2
logoright_name: images/Uni_Bonn_Picture.png
logoleft_name: images/INRES_Logo.png
primary_colour: "white"
title_textcol: "black"
author_textcol: "black"
affiliation_textcol: "black"
sectitle_textcol: "black"
poster_height: "46in"
poster_width: "33in"
output: 
  posterdown::posterdown_html:
    self_contained: false
bibliography: EVPI.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# What is EVPI

The expected value of perfect information (EVPI) is used to express maximized expected utility. It is the difference between the expected value given perfect information and the best expected value given current alternatives [@Strong2014]. EVPI can help identify critical knowledge gaps [@Coyle2008; @hubbard2014] and reveal variables for which more information could inform the best decision option  [@lanzanova2019]. EVPI is often expressed as the highest price that decision makers should be willing to pay for perfect information [@hubbard2014]. However, there are often decision criterion other than money. Therefore, we define EVPI as the potential gain given perfect information on all of the unknown model factors.

EVPI is calculated as the expected value $EV$ of the decision $D$ with perfect information $PI$, minus the expected value of the decision with current imperfect information $II$:
$$
EVPI = EV D|PI - EV D|II
$$

# Calculating EVPI

## Discrete data 

Calculating $EVPI$ with discrete data can be done using estimation of probabilities and possible gains or losses. We use the example of investment in the stock market vs. deposits (bonds): 

<img src="images/stock_market_example.jpg" alt="stock market example" align="center" width = "75%" height="75%"/>

The expected value of deposit investment $Expdeposit$ is calculated as the probability of different states of the economy (x-axis) times the expected loss or gain in each condition (y-axis):
$$
Expdeposit : 0.2 \cdot 500 + 0.3 \cdot 500 
		+ 0.5 \cdot 500 		= 500 
$$
Likewise, expected value of stock investment $Expstock$ is the probability of each possible state of the economy (x-axis) times the expected losses or gains (y-axis):
$$ Expstock:   0.2 \cdot -800 + 0.3 \cdot 600
		+ 0.5 \cdot 1500		= 680 $$
		
Because  $Expstock$ is the more likely decision to result in a gain it is referred to as the Expected Maximum Value $EMV$.

The expected value of the decision *given* perfect information $EV|PI$ is calculated as the sum of all the best options (always making the more gainful choice) multipled by the respective probabilities:
$$
EV|PI :     0.2 \cdot 500 + 0.3 \cdot 600 
		+ 0.5 \cdot 1500  		= 1030
$$

The Expected Value of Perfect Information $EVPI$ is then calculated as the difference between the decision given perfect information $EV|PI$ and the the Expected Maximum Value $EMV$.
$$
EVPI :      1030 – 680 		= 350
$$
Knowing the direction the market will go (having perfect information) before making our decision would help us take the best deision here. We should be willing to pay up to 350€ for perfect information on the future state of the economy. 

## Continuous data

In the following example of an agricultural decision to apply fertilizer, we assume that the nutrient content of the soil will follow a normal distribution and that the additional gain in yield under the decision not to apply fertilizer will remain constant (<span style="color:green">green line</span>). 

We simulate a response of the application of fertilizer (<span style="color:red">red line</span>) to show that at a certain point the positive results of the application ends and the fertilizer starts to cause losses in yield.

A and B are the 'areas under the curve' and are calculated by taking the integral of the curve up to and from the point of intersection with the zero line, respectively.

<img src="images/Agriculture_example.jpg" alt="agriculture example" align="center" width = "75%" height="75%"/>

In this case the expected value of the decision to apply no fertilizer is zero. The expected value of applying fertilizer is equal to $A - B$, which has a small positive value ($A$ is greater than $B$). This is the decision with the expected maximum value $EMV$ under uncertainty. 

The Expected Value given Perfect Information $EV|PI$ is equal to $A$ and $EVPI$ is caculated as the difference between this and $EMV$.

$$
EVPI :      A – (A - B) = B
$$

# R Tools

The *empirical_EVPI()* function in R's decisionSupport library [@decisionSupport2017] calculates EVPI for a simple model with continuous data like the one above. The *multi_EVPI()* function does the same with more complex models with multiple variables.

# References


